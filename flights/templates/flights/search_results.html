{% extends "base.html" %}
{% load static %}

{% block title %}Resultados de Vuelos | Aerolínea EFI{% endblock %}

{% block content %}

<div class="container mt-5 pt-5">
    
    <h2 class="mb-4">Vuelos Encontrados</h2>
    
    <div class="search-container mb-4" style="margin-top: 20px; padding: 15px;">
        <form method="get" action="{% url 'search_flights' %}" class="search-form-row">
            <div class="form-group-flight">
                <label for="{{ search_form.origin.id_for_label }}" style="font-size: 0.8em;">Origen</label>
                {{ search_form.origin }}
            </div>
            <div class="form-group-flight">
                <label for="{{ search_form.destination.id_for_label }}" style="font-size: 0.8em;">Destino</label>
                {{ search_form.destination }}
            </div>
            <div class="form-group-flight">
                <label for="{{ search_form.date.id_for_label }}" style="font-size: 0.8em;">Fecha</label>
                {{ search_form.date }}
            </div>
            <div class="form-group-flight" style="flex-grow: 0;">
                <button type="submit" class="search-button" style="height: 42px; padding: 10px 15px; font-size: 0.9em;">Modificar</button>
            </div>
        </form>
    </div>
    
    <hr>
    
    {% if results %}
        <p class="text-success">{{ results|length }} vuelos disponibles que coinciden con tu búsqueda.</p>
        
        <div class="row">
            {% for flight in results %}
                <div class="col-md-12 mb-3">
                    <div class="card flight-result-card shadow-sm border-0">
                        <div class="card-body d-flex justify-content-between align-items-center p-3">
                            
                            <div class="flight-info">
                                <h5 class="card-title text-primary mb-1">
                                    {{ flight.origin }} ➡️ {{ flight.destination }}
                                </h5>
                                <p class="card-text mb-0">
                                    Vuelo **{{ flight.flight_number }}** | Avión: {{ flight.aircraft.model }}
                                </p>
                                <p class="card-text text-muted" style="font-size: 0.9em;">
                                    Sale: **{{ flight.departure_time|date:"d M H:i" }}** | Llega: {{ flight.arrival_time|date:"d M H:i" }}
                                </p>
                            </div>
                            
                            <div class="flight-price text-end">
                                <h4 class="text-success">${{ flight.price|floatformat:2 }}</h4>
                                <a href="{% url 'flight_detail' flight_id=flight.id %}" class="btn search-button" style="padding: 5px 15px; font-size: 0.9em;">
                                    Ver Detalle
                                </a>
                            </div>

                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        
    {% else %}
        <div class="alert alert-warning">
            No encontramos vuelos disponibles con esos criterios. Por favor, intenta modificar tu búsqueda o <a href="{% url 'flights:index' %}">volver a la página principal</a>.
        </div>
    {% endif %}

    <div class="mt-5 text-center">
        <a href="{% url 'flights:index' %}" class="btn btn-secondary"> 
            ⬅️ Volver a Buscar
        </a>
    </div>

</div>

{% endblock content %}